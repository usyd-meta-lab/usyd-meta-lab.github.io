<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>USYD Meta Lab ‚Ä¢ Thesis Timeline</title>
<style>
  :root{
    --bg: radial-gradient(1200px 800px at 20% -10%, #eef2ff 0%, #ffffff 50%, #ffffff 100%);
    --ink:#0f172a; --muted:#475569; --border:#e5e7eb;
    --accent:#1e40af; --accent2:#6d28d9;
    --radius:18px; --space:16px; --maxw:1100px;
    --phase-proposal:#0ea5e9;   /* cyan */
    --phase-ethics:#22c55e;     /* green */
    --phase-design:#f59e0b;     /* amber */
    --phase-collect:#a855f7;    /* purple */
    --phase-analyze:#ef4444;    /* red */
    --phase-write:#3b82f6;      /* blue */
    --phase-submit:#10b981;     /* emerald */
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0; font:16px/1.55 system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;
    color:var(--ink);
    background:var(--bg);
  }
  header{
    position:sticky; top:0; z-index:10;
    backdrop-filter: blur(10px);
    background:rgba(255,255,255,.7);
    border-bottom:1px solid var(--border);
  }
  .wrap{max-width:var(--maxw); margin:0 auto; padding:18px var(--space);}
  .title{display:flex; align-items:center; gap:12px;}
  .title h1{margin:0; font-size:22px;}
  .title small{color:var(--muted)}
  .title img{height:40px}

  /* Control bar */
  .controls{
    display:grid; gap:12px; grid-template-columns: 1.3fr 1fr 1fr auto;
    margin-top:10px; align-items:end;
  }
  @media (max-width: 900px){ .controls{grid-template-columns:1fr 1fr} }
  @media (max-width: 520px){ .controls{grid-template-columns:1fr} }
  label{display:block; font-size:12px; color:var(--muted); margin:0 0 6px;}
  input, select, button{
    width:100%; padding:10px 12px; border:1px solid var(--border);
    background:#fff; border-radius:12px; font:inherit; color:inherit;
  }
  .btn{
    background:linear-gradient(135deg,var(--accent),var(--accent2));
    border:none; color:#fff; font-weight:700; cursor:pointer;
    box-shadow:0 8px 20px rgba(29,78,216,.18);
  }
  .btn:hover{filter:brightness(.97)}
  .legend{display:flex; flex-wrap:wrap; gap:8px; margin-top:6px}
  .pill{display:inline-flex; align-items:center; gap:6px; font-size:12px; color:var(--muted)}
  .swatch{width:12px; height:12px; border-radius:999px; display:inline-block}

  /* Timeline */
  .timeline-wrap{
    max-width:var(--maxw); margin:20px auto; padding:0 var(--space) 20px;
  }
  .timeline{
    position:relative; overflow:auto; -webkit-overflow-scrolling:touch;
    border:1px solid var(--border); border-radius:var(--radius); background: #fff;
    padding:18px; box-shadow:0 10px 40px rgba(2,6,23,.06);
  }
  .scale{
    position:relative; height:72px; border-bottom:1px dashed #e6e8ef; margin-bottom:8px;
  }
  .tick{
    position:absolute; bottom:0; transform:translateX(-50%);
    width:1px; height:12px; background:#cbd5e1;
  }
  .tick small{position:absolute; bottom:14px; left:50%; transform:translateX(-50%);
    color:var(--muted); font-size:11px; white-space:nowrap;}
  .rail{
    position:relative; height:10px; margin-top:16px; background:#f1f5f9; border-radius:999px;
  }
  .milestone{
    position:absolute; top:50%; transform:translate(-50%,-50%);
    display:flex; align-items:center; gap:8px;
  }
  .dot{
    width:18px; height:18px; border-radius:999px; border:2px solid #fff; box-shadow:0 3px 10px rgba(2,6,23,.15);
  }
  .badge{
    background:#fff; border:1px solid var(--border); padding:6px 10px; border-radius:10px;
    font-size:13px; box-shadow:0 6px 16px rgba(2,6,23,.06);
  }
  .milestone:hover .badge{box-shadow:0 12px 26px rgba(2,6,23,.12)}

  /* Checklist panel */
  .panel{
    max-width:var(--maxw); margin:0 auto 26px; padding:16px var(--space);
    display:grid; gap:16px; grid-template-columns: 1.4fr .6fr;
  }
  @media (max-width: 900px){ .panel{grid-template-columns:1fr} }
  .card{
    border:1px solid var(--border); border-radius:var(--radius); background:#fff;
    padding:16px; box-shadow:0 8px 30px rgba(2,6,23,.06);
  }
  .card h3{margin:0 0 8px; font-size:18px;}
  .steps{display:grid; gap:10px; margin-top:8px}
  .step{display:flex; gap:10px}
  .step input{width:auto}
  .muted{color:var(--muted); font-size:13px}

  .printbar{display:flex; gap:10px; justify-content:flex-end}
  .ghost{
    background:#fff; border:1px solid var(--border); color:var(--ink);
    box-shadow:0 4px 14px rgba(2,6,23,.04)
  }
</style>
</head>
<body>

<header>
  <div class="wrap">
    <div class="title">
      <img src="https://usyd-meta-lab.github.io/images/logo.PNG" alt="USYD Meta Lab Logo">
      <h1>Thesis Timeline</h1>
      <small id="updated" aria-live="polite"></small>
    </div>

    <div class="controls" role="region" aria-label="Timeline controls">
      <div>
        <label for="degree">Degree</label>
        <select id="degree">
          <option value="12">Honours (12 months)</option>
          <option value="24">Masters (24 months)</option>
          <option value="42" selected>PhD (3.5 years / 42 months)</option>
        </select>
      </div>
      <div>
        <label for="start">Start date</label>
        <input id="start" type="month" />
      </div>
      <div>
        <label for="scale">Tick every</label>
        <select id="scale">
          <option value="1">1 month</option>
          <option value="3" selected>3 months (quarterly)</option>
          <option value="6">6 months</option>
        </select>
      </div>
      <div>
        <button class="btn" id="rebuild">Build timeline</button>
      </div>
      <div class="legend" style="grid-column: 1 / -1">
        <span class="pill"><span class="swatch" style="background:var(--phase-proposal)"></span>Proposal</span>
        <span class="pill"><span class="swatch" style="background:var(--phase-ethics)"></span>Ethics</span>
        <span class="pill"><span class="swatch" style="background:var(--phase-design)"></span>Design</span>
        <span class="pill"><span class="swatch" style="background:var(--phase-collect)"></span>Data collection</span>
        <span class="pill"><span class="swatch" style="background:var(--phase-analyze)"></span>Analysis</span>
        <span class="pill"><span class="swatch" style="background:var(--phase-write)"></span>Writing</span>
        <span class="pill"><span class="swatch" style="background:var(--phase-submit)"></span>Submission</span>
      </div>
    </div>
  </div>
</header>

<main>
  <div class="timeline-wrap">
    <div class="timeline" id="timeline" aria-live="polite">
      <div class="scale" id="scaleBar"></div>
      <div class="rail" id="rail"></div>
    </div>
  </div>

  <section class="panel">
    <div class="card">
      <h3>Milestone checklist</h3>
      <div class="steps" id="checklist"></div>
      <p class="muted">Tip: print or save as PDF once you‚Äôve customised dates.</p>
    </div>
    <div class="card">
      <h3>Export</h3>
      <div class="printbar">
        <button class="ghost" onclick="window.print()">üñ®Ô∏è Print / Save PDF</button>
        <button class="ghost" id="copyLink">üîó Copy shareable link</button>
      </div>
      <p class="muted">The link includes your degree, start month, and scale.</p>
    </div>
  </section>
</main>

<script>
/* ------------------- Model your milestones here ------------------- */
/* Each item: { label, phase, offsetMonths } (offset from start date) */
const BASE_MILESTONES = [
  { label: "Meet supervisor & scope thesis", phase:"proposal", offset: 0 },
  { label: "Literature map & research questions", phase:"proposal", offset: 1 },
  { label: "Draft proposal", phase:"proposal", offset: 2 },
  { label: "Proposal review/confirmation", phase:"proposal", offset: 3 },

  { label: "Ethics application submitted", phase:"ethics", offset: 4 },
  { label: "Ethics approval received", phase:"ethics", offset: 6 },

  { label: "Study design finalised (pilots done)", phase:"design", offset: 6 },
  { label: "Pre-registration (if applicable)", phase:"design", offset: 7 },

  { label: "Data collection start", phase:"collect", offset: 8 },
  { label: "Midpoint data quality check", phase:"collect", offset: 10 },
  { label: "Data collection complete", phase:"collect", offset: 14 },

  { label: "Analysis plan executed", phase:"analyze", offset: 15 },
  { label: "Results synthesis & figures", phase:"analyze", offset: 17 },

  { label: "Write: Intro & Methods", phase:"write", offset: 18 },
  { label: "Write: Results", phase:"write", offset: 20 },
  { label: "Write: Discussion & Abstract", phase:"write", offset: 22 },
  { label: "Full draft to supervisors", phase:"write", offset: 23 },

  { label: "Final revisions complete", phase:"submit", offset: 24 },
  { label: "Submit thesis üéâ", phase:"submit", offset: 25 },
];

/* Degree-specific adjustments (add/shift milestones) */
const DEGREE_VARIANTS = {
  12:  BASE_MILESTONES.map(m => ({...m, offset: Math.round(m.offset * (12/24)) })), // compress
  24:  BASE_MILESTONES,
  42:  BASE_MILESTONES.concat([
          { label:"Annual review 1", phase:"proposal", offset: 12 },
          { label:"Annual review 2", phase:"collect",  offset: 24 },
          { label:"Thesis by publication decision", phase:"write", offset: 28 },
          { label:"Pre-submission seminar", phase:"submit", offset: 40 },
       ])
};

/* -------------------------- Rendering logic ----------------------- */
const els = {
  degree: document.getElementById('degree'),
  start: document.getElementById('start'),
  scale: document.getElementById('scale'),
  rebuild: document.getElementById('rebuild'),
  scaleBar: document.getElementById('scaleBar'),
  rail: document.getElementById('rail'),
  timeline: document.getElementById('timeline'),
  checklist: document.getElementById('checklist'),
  updated: document.getElementById('updated'),
  copyLink: document.getElementById('copyLink'),
};

const PHASE_COLOR = {
  proposal:'var(--phase-proposal)',
  ethics:'var(--phase-ethics)',
  design:'var(--phase-design)',
  collect:'var(--phase-collect)',
  analyze:'var(--phase-analyze)',
  write:'var(--phase-write)',
  submit:'var(--phase-submit)',
};

function monthKey(d){ return `${d.getFullYear()}-${String(d.getMonth()+1).padStart(2,'0')}`; }
function addMonths(d, n){
  const dt = new Date(d.getTime());
  const m = dt.getMonth() + n;
  dt.setMonth(m, 1); // avoid month-end rollovers
  return dt;
}
function fmtMonth(d){
  return d.toLocaleString(undefined,{month:'short', year:'numeric'});
}

function build(){
  const totalMonths = Number(els.degree.value);
  const startStr = els.start.value; // yyyy-mm
  if(!startStr){
    els.timeline.setAttribute('aria-busy','true');
    els.scaleBar.innerHTML = '';
    els.rail.innerHTML = '<div class="muted" style="padding:10px 0 0 0">Select a start month to generate your timeline.</div>';
    els.checklist.innerHTML = '';
    els.updated.textContent = '';
    return;
  }
  const start = new Date(startStr+'-01T00:00:00');
  const tickEvery = Number(els.scale.value);

  // 1) Build scale ticks
  els.scaleBar.innerHTML = '';
  for(let i=0;i<=totalMonths;i+=tickEvery){
    const left = (i/totalMonths)*100;
    const t = document.createElement('div');
    t.className = 'tick'; t.style.left = left+'%';
    const when = addMonths(start, i);
    t.innerHTML = `<small>${fmtMonth(when)}</small>`;
    els.scaleBar.appendChild(t);
  }

  // 2) Rail + milestones
  const milestones = (DEGREE_VARIANTS[els.degree.value] || BASE_MILESTONES)
    .filter(m => m.offset <= totalMonths);

  els.rail.innerHTML = '';
  milestones.forEach(m => {
    const left = (m.offset/totalMonths)*100;
    const el = document.createElement('div');
    el.className = 'milestone';
    el.style.left = `calc(${left}% )`;
    const when = addMonths(start, m.offset);
    const color = PHASE_COLOR[m.phase] || '#64748b';
    el.innerHTML = `
      <span class="dot" style="background:${color}"></span>
      <span class="badge" title="${m.label} ‚Äî ${fmtMonth(when)}">
        ${m.label} <span class="muted" style="margin-left:6px">${fmtMonth(when)}</span>
      </span>
    `;
    els.rail.appendChild(el);
  });

  // 3) Checklist
  els.checklist.innerHTML = milestones.map(m=>{
    const when = fmtMonth(addMonths(start, m.offset));
    const color = PHASE_COLOR[m.phase] || '#64748b';
    return `
      <label class="step">
        <input type="checkbox">
        <span>
          <strong style="color:${color}">${m.label}</strong>
          <div class="muted">${when} ‚Ä¢ ${m.phase.charAt(0).toUpperCase()+m.phase.slice(1)}</div>
        </span>
      </label>
    `;
  }).join('');

  els.updated.textContent = `Covers ${fmtMonth(start)} ‚Üí ${fmtMonth(addMonths(start,totalMonths))}`;
  els.timeline.removeAttribute('aria-busy');
}

/* Shareable link (degree, start, scale) */
function applyFromURL(){
  const u = new URL(location.href);
  const d = u.searchParams.get('deg'); if(d) els.degree.value = d;
  const s = u.searchParams.get('start'); if(s) els.start.value = s;
  const sc = u.searchParams.get('scale'); if(sc) els.scale.value = sc;
}
function copyLink(){
  const u = new URL(location.href);
  u.searchParams.set('deg', els.degree.value);
  u.searchParams.set('start', els.start.value || '');
  u.searchParams.set('scale', els.scale.value);
  navigator.clipboard.writeText(u.toString()).then(()=>{
    els.copyLink.textContent = '‚úÖ Copied!';
    setTimeout(()=> els.copyLink.textContent='üîó Copy shareable link', 1500);
  });
}

/* Defaults */
(function initDefaults(){
  // default start = this month
  const d = new Date();
  const ym = `${d.getFullYear()}-${String(d.getMonth()+1).padStart(2,'0')}`;
  els.start.value = ym;
  applyFromURL();
  build();
})();

els.rebuild.addEventListener('click', build);
els.degree.addEventListener('change', build);
els.start.addEventListener('change', build);
els.scale.addEventListener('change', build);
els.copyLink.addEventListener('click', copyLink);
</script>
</body>
</html>